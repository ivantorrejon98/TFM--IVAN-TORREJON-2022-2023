
import pandas as pd

#Abro los ficheros con los que voy a tratar

df_vuln_ibm_iot = pd.read_excel('vulnerabilidades_ibm_iot_2023.xlsx')
df_vuln_ibm_sh=pd.read_excel('vulnerabilidades_ibm_smart_home_2023.xlsx')




#Variables donde almacenare el contador de niveles de explotabilidad para vulnerabilidades IBM 
unproven_exploitability_iot=0
poc_exploitability_iot=0
unproven_exploitability_sh=0
poc_exploitability_sh=0
high_exploitability_sh=0
high_exploitability_iot=0

#Compruebo el nivel de explotabilidad en vulnerabilidades IBM para IOT

for i in range(0,len(df_vuln_ibm_iot["x_xfe_exploitability"])):
    if(df_vuln_ibm_iot["x_xfe_exploitability"][i]=='Unproven'):
        unproven_exploitability_iot+=1
    if(df_vuln_ibm_iot["x_xfe_exploitability"][i]=='Proof of Concept'):
        poc_exploitability_iot+=1
    if(df_vuln_ibm_iot["x_xfe_exploitability"][i]=='High'):
        high_exploitability_iot+=1

print("**************************ESTADÍSTICAS NIVEL DE EXPLOTABILIDAD EN VULNERABILIDADES IBM IOT********************************")
print("\n")
print("EN "+str(unproven_exploitability_iot)+" VULNERABILIDADES LA EXPLOTABILIDAD NO ESTA PROBADA \n")
print("EN "+str(poc_exploitability_iot)+" VULNERABILIDADES LA EXPLOTABILIDAD REQUIERE UNA PRUEBA DE CONCEPTO \n")
print("EN "+str(high_exploitability_iot)+" VULNERABILIDADES LA EXPLOTABILIDAD ES ALTA \n")
print("\n")
print("***************************PORCENTAJE NIVEL DE EXPLOTABILIDAD EN VULNERABILIDADES IBM IOT********************************")
print("\n")
print("EN EL "+str(float(((unproven_exploitability_iot*100)/len(df_vuln_ibm_iot["x_xfe_exploitability"]))))+"% DE LAS VULNERABILIDADES LA EXPLOTABILIDAD NO ESTA PROBADA \n")
print("EN EL "+str(float(((poc_exploitability_iot*100)/len(df_vuln_ibm_iot["x_xfe_exploitability"]))))+"% DE LAS VULNERABILIDADES LA EXPLOTABILIDAD REQUIERE UNA PRUEBA DE CONCEPTO \n")
print("EN EL "+str(float(((high_exploitability_iot*100)/len(df_vuln_ibm_iot["x_xfe_exploitability"]))))+"% DE LAS VULNERABILIDADES LA EXPLOTABILIDAD ES ALTA \n")

print("\n")


#Compruebo el nivel de explotabilidad en vulnerabilidades IBM para SMART HOME

for j in range(0,len(df_vuln_ibm_sh["x_xfe_exploitability"])):
    if(df_vuln_ibm_sh["x_xfe_exploitability"][j]=='Unproven'):
        unproven_exploitability_sh+=1
    if(df_vuln_ibm_sh["x_xfe_exploitability"][j]=='Proof of Concept'):
        poc_exploitability_sh+=1
    if(df_vuln_ibm_sh["x_xfe_exploitability"][j]=='High'):
        high_exploitability_sh+=1






print("**************************ESTADÍSTICAS NIVEL DE EXPLOTABILIDAD EN VULNERABILIDADES IBM SMART HOME********************************")
print("\n")
print("EN "+str(unproven_exploitability_sh)+" VULNERABILIDADES LA EXPLOTABILIDAD NO ESTA PROBADA \n")
print("EN "+str(poc_exploitability_sh)+" VULNERABILIDADES LA EXPLOTABILIDAD REQUIERE UNA PRUEBA DE CONCEPTO \n")
print("EN "+str(high_exploitability_sh)+" VULNERABILIDADES LA EXPLOTABILIDAD ES ALTA \n")

print("***************************PORCENTAJE NIVEL DE EXPLOTABILIDAD EN VULNERABILIDADES IBM SMART HOME********************************")
print("\n")
print("EN EL "+str(float(((unproven_exploitability_sh*100)/len(df_vuln_ibm_sh["x_xfe_exploitability"]))))+"% DE LAS VULNERABILIDADES LA EXPLOTABILIDAD NO ESTA PROBADA \n")
print("EN EL "+str(float(((poc_exploitability_sh*100)/len(df_vuln_ibm_sh["x_xfe_exploitability"]))))+"% DE LAS VULNERABILIDADES LA EXPLOTABILIDAD REQUIERE UNA PRUEBA DE CONCEPTO \n")
print("EN EL "+str(float(((high_exploitability_sh*100)/len(df_vuln_ibm_sh["x_xfe_exploitability"]))))+"% DE LAS VULNERABILIDADES LA EXPLOTABILIDAD ES ALTA \n")

print("\n")






print("**************************ESTADÍSTICAS NIVEL DE EXPLOTABILIDAD EN VULNERABILIDADES IBM PARTE IOT Y SMART HOME CONJUNTAS********************************")
print("\n")
print("EN "+str(unproven_exploitability_sh+unproven_exploitability_iot)+" VULNERABILIDADES LA EXPLOTABILIDAD NO ESTA PROBADA \n")
print("EN "+str(poc_exploitability_sh+poc_exploitability_iot)+" VULNERABILIDADES LA EXPLOTABILIDAD REQUIERE UNA PRUEBA DE CONCEPTO \n")
print("EN "+str(high_exploitability_sh+high_exploitability_iot)+" VULNERABILIDADES LA EXPLOTABILIDAD ES ALTA \n")

print("***************************PORCENTAJE NIVEL DE EXPLOTABILIDAD EN VULNERABILIDADES IBM PARTE IOT Y SMART HOME CONJUNTAS********************************")
print("\n")
print("EN EL "+str(float((((unproven_exploitability_sh+unproven_exploitability_iot)*100)/(len(df_vuln_ibm_sh["x_xfe_exploitability"])+len(df_vuln_ibm_iot["x_xfe_exploitability"])))))+"% DE LAS VULNERABILIDADES LA EXPLOTABILIDAD NO ESTA PROBADA \n")
print("EN EL "+str(float((((poc_exploitability_sh+poc_exploitability_iot)*100)/(len(df_vuln_ibm_sh["x_xfe_exploitability"])+len(df_vuln_ibm_iot["x_xfe_exploitability"])))))+"% DE LAS VULNERABILIDADES LA EXPLOTABILIDAD REQUIERE UNA PRUEBA DE CONCEPTO \n")
print("EN EL "+str(float((((high_exploitability_sh+high_exploitability_iot)*100)/(len(df_vuln_ibm_sh["x_xfe_exploitability"])+len(df_vuln_ibm_iot["x_xfe_exploitability"])))))+"% DE LAS VULNERABILIDADES LA EXPLOTABILIDAD ES ALTA \n")

print("\n")
















